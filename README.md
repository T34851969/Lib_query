# 图书馆综合查询系统

一个基于 Python 和 SQLite 的本地图书馆馆藏条目检索系统，支持多种查询方式，包括标题关键词搜索、索书号部分匹配、标准号（如 ISBN）精确查询，以及批量导入查询。适用于中小型图书馆或个人藏书管理。

## 功能

- **多维度检索**：
  - 标题关键词搜索（支持多关键词）
  - 索书号前缀模糊匹配（自动按层级索引）
  - 标准号（ISBN 等）精确查询
- **批量处理**：
  - 从 `.txt` 或 `.csv` 文件批量导入索书号或标准号进行查询
- **图形界面**（GUI）：
  - 使用 `tkinter` 构建
- **自动建库**：
  - 首次运行时自动从 Excel 文件（`.xlsx`/`.xls`）创建 SQLite 数据库
- **高效索引**：
  - 对标题、索书号、标准号及索书号各层级字段建立数据库索引，提升查询速度
- **结果导出**：
  - 支持导出为 `.xlsx` 或 `.csv` 格式，便于后续处理

## 技术栈

- Python 3.7+
- `pandas`：数据处理
- `sqlite3`：本地数据库
- `tkinter`：图形用户界面
- `openpyxl` / `xlrd`（由 pandas 依赖）：读取 Excel 文件

> 注意：项目不依赖网络，所有数据存储在本地，适合离线使用。

## 安装与运行

### 1. 克隆仓库（或下载 ZIP）

```bash
git clone https://github.com/T34851969/MyProj.git
cd library-query-system
```

### 2. 安装依赖

```bash
pip install pandas openpyxl
```

- 另请自行删除不需要的部分

### 3. 准备数据

- 将馆藏文件（.xlsx格式）放在项目根目录下。在这个程序中：
  - B列为书名
  - D列为索书号
  - M列为标准号（ISBN）

> 该程序对E-K列的索书号切片重命名为level_1到level_7，视需求更改

### 4. 运行程序

```bash
python main.py
```

> 或者使用VS Code运行
> 注意：首次运行自动创建`图书馆详细馆藏.db`

## 界面

- 标签页1：标题搜索
  - 根据关键词（逗号分隔），支持多条件查询（或）
- 标签页2：索书号部分搜索
  - 输入索书号的一个切片进行搜索，一共分七级
- 标签页3：精确/批量查询
  - 标准号或完整索书号，可进行单个于批量查询，批量查询从文件导入

## 项目结构

```结构
.
├── main.py          # 入口脚本
├── db.py                        # 数据库类与查询逻辑
├── utils.py                     # 工具函数（查找 Excel 等）
├── gui.py                       # GUI 实现（tkinter）
├── README.md                    # 本说明文件
├── 馆藏.xlsx                    # 示例数据（需自行提供）
├── 图书馆详细馆藏.db             # 自动生成的数据库（运行后产生）
└── (查询结果文件).xlsx / .csv    # 搜索结果自动保存于此，名称包含关键词
```

## 模块说明

为提高可维护性，原单文件已分为三个模块：

- `db.py`：包含 `LibraryDatabase`，负责与 SQLite 交互和各种查询函数。
- `utils.py`：辅助工具函数（例如在当前目录查找 Excel 文件）。
- `gui.py`：包含 `LibraryApp` GUI 类，负责界面与用户交互。

运行方式保持不变：

```bash
python main.py
```

## 注意

- 所属层级索引基于列位置，如有需求请自行改动
- 批量查询结果按照搜索条目分别保存，不合并
- 文件名超过20字符自动截断

## 许可证

- 本项目是个人学习办公编程的阶段性作品，如有不足请多关照
  